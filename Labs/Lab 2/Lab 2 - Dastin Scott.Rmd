---
title: "Lab 2"
author: "Dastin Scott"
date: "`r format(Sys.Date())`"
output:
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Task 1

```{r}
getwd()

```

# Task 2

```{r}
epagas <- read.csv("EPAGAS.csv")
head(epagas)

```

# Task 3
```{r}
mpg <- epagas$MPG
z <- (mpg - mean(mpg)) / sd(mpg)
mean(z)
var(z)

possible_outliers <- mpg[abs(z) > 2 & abs(z) <= 3]
outliers <- mpg[abs(z) > 3]
possible_outliers
outliers

groups <- ifelse(abs(z) > 3, "Outlier",
                 ifelse(abs(z) > 2, "Possible Outlier", "Normal"))
groups <- factor(groups, levels = c("Normal","Possible Outlier","Outlier"))
cols <- c("Normal" = "black",
          "Possible Outlier" = "blue",
          "Outlier" = "red")
library(lattice)
my.cols <- c("Normal" = "black", "Possible Outlier" = "blue", "Outlier" = "red")
dotplot(as.factor(seq_along(mpg)) ~ mpg,
        groups = groups,
        pch = 19,
        cex = 0.75,
        par.settings = list(superpose.symbol = list(col = unname(my.cols), pch = 19)),
        scales = list(y = list(at = seq(0, length(mpg), by = 5))),
        xlab = "MPG",
        ylab = "Index",
        main = "MPG Dotplot",
        auto.key = list(space = "right", points = TRUE, columns = 1))
```

# Task 4
```{r}
boxplot(mpg,
        horizontal = TRUE,
        notch = TRUE,
        col = "white",
        border = "black",
        main = "Boxplot of MPG",
        xlab = "Miles per Gallon")

k <- 2
chebyshev_bound <- 1 - 1/k^2
chebyshev_bound

within_2sd <- mean(abs(mpg - mean(mpg)) <= 2 * sd(mpg))
within_2sd

```

**Does Chebyshevâ€™s theorem agree with the data?**

  Yes, because proportion is bigger than 0.75.

**What proportion (according to the empirical rule) of the data should be within 2 standard deviations of the mean?**

  0.95 (95%)

**How well does it correspond?**

  The proportion is close to 95%, so it corresponds well. 

**Is the empirical rule valid in this case? Why?**

  Yes, because the mpg data looks roughly bell shaped. 
